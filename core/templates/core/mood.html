{% extends 'core/dashboard_base.html' %}
{% load static %}

{% block title %}Mood{% endblock %}

{% block content %}
<div class="card">
  <div class="card-title">Mood Analysis</div>
  <form method="post">
    {% csrf_token %}
    <label class="block mb-2 text-sm text-gray-600">Describe how you feel right now</label>
    <textarea name="text" rows="4" class="w-full border-2 border-[#2b2b2b] p-3 mb-3" placeholder="Write your mood, thoughts, or how your day went..."></textarea>
    <button type="submit" class="btn-primary">Analyze</button>
  </form>
</div>

{% if result %}
<div class="card" style="background:#d1fae5;border-color:#10b981;">
  <div class="card-title">Result</div>
  <p><strong>Mood:</strong> {{ result.top }}</p>
  {% if recommendation %}
  <p class="mt-2"><strong>Recommendation:</strong> {{ recommendation }}</p>
  {% endif %}
  {% if result.scores %}
  <div class="mt-3">
    <strong>Scores</strong>
    <ul class="list-disc ml-6">
      {% for k, v in result.scores.items %}
      <li>{{ k }}: {{ v|floatformat:2 }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
</div>
{% endif %}

<div class="card">
  <div class="card-title">Recent Analyses</div>
  {% if history %}
  <ul class="space-y-2">
    {% for h in history %}
    <li class="border-b border-[#2b2b2b] pb-2">
      <div class="flex justify-between">
        <span class="font-semibold">{{ h.top }}</span>
        <span class="text-sm text-gray-500">{{ h.created_at }}</span>
      </div>
      <div class="text-sm text-gray-700 mt-1">{{ h.text|truncatechars:120 }}</div>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p class="text-gray-600">No analyses yet.</p>
  {% endif %}
</div>
{% endblock %}
